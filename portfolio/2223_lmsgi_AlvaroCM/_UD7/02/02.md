## ACTIVIDAD 7.2 XQUERY LIBRERIA

**Pregunta1**

```Xquery
for $x in doc("books")/bookstore/book
where $x/year = 2005
return <lib2005>{$x/title}{$x/author}</lib2005>

```

**Pregunta2**

```Xquery
for $x in doc("books")/bookstore/book
let $a:= $x/year/text()
return <publicacion>{$a}</publicacion>
```

**Pregunta3**

```Xquery
for $x in doc("books")/bookstore/book
order by $x/category, $x/title
return $x
```

**Pregunta4**

```Xquery
for $x in doc("books")/bookstore
let $a:= count($x/book)
return concat($x/book/title/text(),
              <total>{$a}</total>)

```

**Pregunta5**

```Xquery
let $books := doc('books')//book
return
  <result>
    {for $book in $books
    return <title>{$book/title/text()}</title>}
    <total>{count($books)}</total>
  </result>

```

**Pregunta6**

```Xquery
let $prices := doc('books')//book/price/number()
return concat("Minimo:",string(min($prices))," ", "Maximo:",string(max($prices)))
```

**Pregunta7**

```Xquery
let $books := doc('books')//book
return
  <result>
    {
    for $book in $books
    let $price := xs:decimal($book/price)
    let $price_con_iva := $price * 1.04
    order by $price_con_iva
    return
      <book>
        <title>{$book/title/text()}</title>
        <price>{$price}</price>
        <price_con_iva>{$price_con_iva}</price_con_iva>
      </book>
    }
  </result>
```

**Pregunta8**

```Xquery
let $prices := sum(doc('books')//book/price/text())
return
    <total>{$prices}</total>
```

**Pregunta9**

```Xquery
let $prices := doc('books')//book/price
return
  <result>
    {$prices}
    <total>{sum($prices)}</total>
  </result>
```

**Pregunta10**

```Xquery
let $books := doc('books')//book
return
  <result>
    {
    for $x in $books
    return
      <book>
        <title>{$x/title/text()}</title>
        <author_count>{count($x/author)}</author_count>
      </book>
    }
  </result>
```

**Pregunta11**

```Xquery
let $books := doc('books')//book
return
  <result>
    {
    for $x in $books
    let $title:= $x/title/text()
    let $authors:= count($x/author)
    return
      <book>
        {concat($title, "(",$authors,")")}
      </book>
    }
  </result>
```

**Pregunta12**

```Xquery
let $books := doc('books')//book
return
    for $x in $books
    where ends-with($x/year, '3')
    return $x/title/text()
```

**Pregunta13**

```Xquery
let $books := doc('books')//book[starts-with(@category, 'c')]
return
    for $x in $books
    return $x/title/text()
```

**Pregunta14**

```Xquery
let $books := doc('books')//book[contains(title/text(), 'X') or contains(title/text(), 'x')]
return
    for $x in $books
    order by $x/title/text() descending
    return $x/title/text()
```

**Pregunta15**

```Xquery
let $books := doc('books')//book
return
  <result>
    {
    for $x in $books
    return
      <book>
        <title>{$x/title/text()}</title>
        <caracteres>{string-length($x/title)}</caracteres>
      </book>
    }
  </result>
```

**Pregunta16**

```Xquery
let $years := distinct-values(doc('books')//book/year)
return
  <result>
    {
       for $x in $years
       return <year>{$x}</year>
    }
  </result>
   
```

**Pregunta17**

```Xquery
  for $x in distinct-values(doc('books')//author)
    order by string-length($x)
    return $x

```

**Pregunta18**

```Xquery
<table>
   {
    for $x in doc('books')//title/text()
     return <tr><td>{$x}</td></tr>
    }
</table>

```
