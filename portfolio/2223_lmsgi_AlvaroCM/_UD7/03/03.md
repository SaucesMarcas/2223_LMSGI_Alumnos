## ACTIVIDAD 7.3 XQUERY BAILES

**Pregunta1**

```Xquery
let $bailes := doc('bailes')//baile
return
  <losbailes>
    {for $baile in $bailes
    return <baile>{$baile/nombre/text()}</baile>}
  </losbailes>
```

**Pregunta2**

```Xquery
let $bailes := doc('bailes')//baile
return
  <losbailes>
    {for $baile in $bailes
    return <baile>{$baile/nombre/text()} ({data($baile/plazas)})</baile>}
  </losbailes>
```

**Pregunta3**

```Xquery
let $bailes := doc('bailes')//baile[precio > 30]
return
  <losbailes>
    {for $baile in $bailes
    return <baile>{$baile/nombre/text()}</baile>}
  </losbailes>
```

**Pregunta4**

```Xquery
let $bailes := doc('bailes')//baile[precio > 30 and precio/@moneda = 'euro']
return
  <losbailes>
    {for $baile in $bailes
    return <baile>{$baile/nombre/text()}</baile>}
  </losbailes>
```

**Pregunta5**

```Xquery
let $bailes := doc('bailes')//baile[starts-with(comienzo, '1/')]
return
  <losbailes>
    {for $baile in $bailes
    return <baile>{$baile/nombre/text()}, {$baile/comienzo/text()}</baile>}
  </losbailes>
```

**Pregunta6**

```Xquery
let $bailes := doc('tu_archivo.xml')//baile
return
  <losbailes>
    {for $baile in $bailes
    order by $baile/sala/text()
    return <baile>{$baile/profesor/text()}, Sala {$baile/sala/text()}</baile>}
  </losbailes>
```

**Pregunta7**

```Xquery
let $bailes := doc('bailes')//baile
let $profesores := distinct-values($bailes/profesor)
return
  <losbailes>
    {for $profesor in $profesores
    let $salas := $bailes[profesor = $profesor]/sala
    order by $profesor
    return <baile>{$profesor}: {string-join($salas, ', ')}</baile>}
 </losbailes>
```

**Pregunta8**

```Xquery
let $bailes := doc('books')//baile
let $precios := $bailes/precio
return
  <media>
    {avg($precios)}
  </media>

```

**Pregunta9**

```Xquery
let $bailes := doc('bailes')//baile[sala = '1']
let $precios := $bailes/precio
return
  <suma>
    {sum($precios)}
  </suma>
```

**Pregunta10**

```Xquery
let $bailes := doc('bailes')//baile[profesor = 'Jesus Lozano']
let $plazas := $bailes/plazas
return
  <total_plazas>
    {sum($plazas)}
  </total_plazas>
```

**Pregunta11**

```Xquery
let $baile := doc('bailes')//baile[profesor = 'Laura Mendiola']
let $plazas := $baile/plazas
let $precio := $baile/precio
return
  <ganancia>
    {sum($plazas) * $precio}
  </ganancia>

```

**Pregunta12**

```Xquery
let $bailes := doc('bailes')//baile[profesor = 'Jesus Lozano']
return
  <losbailes>
    {for $baile in $bailes
    let $plazas := $baile/plazas
    let $precio := $baile/precio
    return <baile>{$baile/nombre/text()}: {sum($plazas) * $precio}</baile>}
  </losbailes>
```

**Pregunta13**

```Xquery
let $bailes := doc('bailes')//baile[starts-with(profesor, 'Laura')]
let $plazas := $bailes/plazas
let $precio := $bailes/precio
return
  <ganancia>
    {sum($plazas) * $precio}
  </ganancia>
```

**Pregunta14**

```Xquery
let $bailes := doc('bailes')//baile
return
  <losbailes>
    {for $baile in $bailes
    let $precio := $baile/precio
    let $descuento := $precio * 0.15
    let $precio_descuento := $precio - $descuento
    order by $baile/nombre/text()
    return <baile>
             <nombre>{$baile/nombre/text()}</nombre>
             <precio>{$precio}</precio>
             <precio_descuento>{$precio_descuento}</precio_descuento>
           </baile>}
  </losbailes>
```

**Pregunta15**

```Xquery
let $bailes := doc('bailes')//baile
return
  <losbailes>
    {for $baile in $bailes
    return <baile>
             <nombre>{$baile/nombre/text()}</nombre>
             <precio>{$baile/precio/text()}</precio>
             <plazas>{$baile/plazas/text()}</plazas>
             <profesor>{$baile/profesor/text()}</profesor>
             <sala>{$baile/sala/text()}</sala>
           </baile>}
  </losbailes>
```

**Pregunta16**

```Xquery
let $bailes := doc('bailes')//baile
return
  <table>
    <tr>
      <th>Nombre del Baile</th>
      <th>Profesor</th>
    </tr>
    {for $baile in $bailes
    return
      <tr>
        <td>{$baile/nombre/text()}</td>
        <td>{$baile/profesor/text()}</td>
      </tr>}
  </table>
```
